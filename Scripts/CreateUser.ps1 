#Création automatiquement des comptes utilisateurs Active Directory.

Import-Module ActiveDirectory

function Create-UserFromCSV {
    param(
        [string]$csvPath
    )

    $usersData = Import-Csv $csvPath

    foreach ($userData in $usersData) {
        $username = $userData.Username
        $password = $userData.Password
        $email = $userData.Email

        New-ADUser -SamAccountName $username -UserPrincipalName "$username@your_domain.com" -Name $username -GivenName $username -Surname "User" -EmailAddress $email -AccountPassword (ConvertTo-SecureString $password -AsPlainText -Force) -Enabled $true
    
        Write-Host "Bravo ! Le user $username a été créé !"
    }
}

Create-UserFromCSV -csvPath "C:\Users\Administrator\Desktop\Admin\Scripts\Users.csv"